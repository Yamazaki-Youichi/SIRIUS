{"name":"SIRIUS","tagline":"Domain specific library for electronic structure calculations","body":"### Welcome to SIRIUS project\r\n\r\nCode block:\r\n    #include \"kernels_common.h\"\r\n\r\n__global__ void create_beta_gk_gpu_kernel\r\n(\r\n    int num_gkvec__,\r\n    int const* beta_desc__,\r\n    cuDoubleComplex const* beta_gk_t,\r\n    double const* gkvec,\r\n    double const* atom_pos,\r\n    cuDoubleComplex* beta_gk\r\n)\r\n{\r\n    int ia = blockIdx.y;\r\n    int igk = blockDim.x * blockIdx.x + threadIdx.x;\r\n\r\n    int nbf              = beta_desc__[array2D_offset(0, ia, 4)];\r\n    int offset_beta_gk   = beta_desc__[array2D_offset(1, ia, 4)];\r\n    int offset_beta_gk_t = beta_desc__[array2D_offset(2, ia, 4)];\r\n\r\n    if (igk < num_gkvec__)\r\n    {\r\n        double p = 0;\r\n        for (int x = 0; x < 3; x++) p += atom_pos[array2D_offset(x, ia, 3)] * gkvec[array2D_offset(x, igk, 3)];\r\n        p *= twopi;\r\n\r\n        double sinp = sin(p);\r\n        double cosp = cos(p);\r\n\r\n        for (int xi = 0; xi < nbf; xi++)\r\n        {\r\n            beta_gk[array2D_offset(igk, offset_beta_gk + xi, num_gkvec__)] =\r\n                cuCmul(beta_gk_t[array2D_offset(igk, offset_beta_gk_t + xi, num_gkvec__)],\r\n                       make_cuDoubleComplex(cosp, -sinp));\r\n        }\r\n    }\r\n}\r\n\r\nextern \"C\" void create_beta_gk_gpu(int num_atoms,\r\n                                   int num_gkvec,\r\n                                   int const* beta_desc,\r\n                                   cuDoubleComplex const* beta_gk_t,\r\n                                   double const* gkvec,\r\n                                   double const* atom_pos,\r\n                                   cuDoubleComplex* beta_gk)\r\n{\r\n    CUDA_timer t(\"create_beta_gk_gpu\");\r\n\r\n    dim3 grid_t(64);\r\n    dim3 grid_b(num_blocks(num_gkvec, grid_t.x), num_atoms);\r\n\r\n    create_beta_gk_gpu_kernel <<<grid_b, grid_t>>>\r\n    (\r\n        num_gkvec,\r\n        beta_desc,\r\n        beta_gk_t,\r\n        gkvec,\r\n        atom_pos,\r\n        beta_gk\r\n    );\r\n}","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}